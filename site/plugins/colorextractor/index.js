!function n(i,c,a){function l(e,t){if(!c[e]){if(!i[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(u)return u(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var s=c[e]={exports:{}};i[e][0].call(s.exports,function(t){return l(i[e][1][t]||t)},s,s.exports,n,i,c,a)}return c[e].exports}for(var u="function"==typeof require&&require,t=0;t<a.length;t++)l(a[t]);return l}({1:[function(t,e,o){!function(){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default={data:function(){return{iconEmpty:{type:"check",back:"theme-empty"},icon:{type:"refresh",back:"theme-process"},processing:!1,completed:[],failed:[]}},props:{files:Array},computed:{count:function(){var t=this.files.length;return t=Object.is(t,void 0)?0:t,t},completedCount:function(){var t=this.completed.length;return t=Object.is(t,void 0)?0:t}},methods:{processImages:function(){var r=this;this.resetArrays(),this.processing=!0,this.files.forEach(function(o,t){r.$api.post("colorextractor/process-image",{id:o.id,index:t}).then(function(t){if(r.completed.push(o.name),r.completedCount==r.count)if(r.failed.length)r.failedExtraction();else{var e=r;setTimeout(function(){e.completedExtraction()},250)}r.setProgress()}).catch(function(t){r.completed.push(o.name),r.failed.push({name:o.filename,message:t.message}),r.completedCount==r.count&&r.failedExtraction(),r.setProgress()})})},setProgress:function(){var t=this.completedCount/this.count*100;t=Math.max(0,Math.min(100,t)),this.$refs.progress.set(t)},completedExtraction:function(){var t=this.$t("colorextractor.notification.completed",{count:this.completedCount},this.completedCount);this.$refs.dialog.close(),this.$store.dispatch("notification/success",t),this.processing=!1,this.currentIndex=0,this.files={}},failedExtraction:function(){var t=this;this.processing=!1,this.currentIndex=0,this.files=this.files.filter(function(e){return t.failed.filter(function(t){return t.name===e.filename}).length})},openDialog:function(){this.resetArrays(),this.$refs.dialog.open()},abortExtraction:function(){this.$refs.dialog.close(),this.processing=!1},resetArrays:function(){this.completed=[],this.failed=[]}}}}(),e.exports.__esModule&&(e.exports=e.exports.default);var r="function"==typeof e.exports?e.exports.options:e.exports;r.render=function(){var o=this,t=o.$createElement,r=o._self._c||t;return r("k-field",o._b({},"k-field",o.$attrs,!1),[0==o.count?r("k-list-item",{staticClass:"colorextractor-empty",attrs:{text:o.$t("colorextractor.button.text.empty"),icon:o.iconEmpty,element:"div"}}):r("k-list-item",{staticClass:"colorextractor-button",attrs:{text:o.$t("colorextractor.button.text"),icon:o.icon,element:"div"},on:{click:o.openDialog}}),o._v(" "),r("k-dialog",{ref:"dialog",attrs:{theme:"negative"}},[o.processing||o.completedCount?!o.processing&&o.failed.length?[r("k-text",[o._v("\n\t    \t\t\t"+o._s(o.$t("colorextractor.dialog.text.error",{count:o.completedCount,failed:o.failed.length},o.completedCount))+"\n\t    \t\t")]),o._v(" "),r("ul",{staticClass:"colorextractor-errors"},o._l(o.failed,function(t,e){return r("li",{staticClass:"error"},[r("strong",[o._v("Filename:")]),o._v(" "+o._s(t.name)+"\n\t    \t\t\t\t"),r("div",{staticClass:"error-message"},[o._v(o._s(t.message))])])})),o._v(" "),r("template",{slot:"footer"},[r("k-button-group",[r("k-button",{attrs:{icon:"cancel"},on:{click:function(t){o.$refs.dialog.close()}}},[o._v(o._s(o.$t("close")))])],1)],1)]:o.processing?[r("k-headline",[o._v(o._s(o.$t("colorextractor.dialog.processing")))]),o._v(" "),r("k-progress",{ref:"progress"}),o._v(" "),r("ul",{staticClass:"k-upload-list"},[r("div",{staticClass:"colorextractor-progress-caption"},[r("p",{staticClass:"k-colextractor-counter"},[o._v(o._s(o.$t("colorextractor.dialog.extracted"))+": "+o._s(o.completedCount)+" / "+o._s(o.count))])])]),o._v(" "),r("template",{slot:"footer"},[r("k-button-group",[r("k-button",{attrs:{icon:"cancel"},on:{click:o.abortExtraction}},[o._v(o._s(o.$t("cancel")))])],1)],1)]:o._e():[r("k-text",{domProps:{innerHTML:o._s(o.$t("colorextractor.dialog.text",{count:o.count},o.count))}}),o._v(" "),r("template",{slot:"footer"},[r("k-button-group",[r("k-button",{attrs:{icon:"cancel"},on:{click:function(t){o.$refs.dialog.close()}}},[o._v(o._s(o.$t("cancel")))]),o._v(" "),r("k-button",{attrs:{icon:"check",theme:"positive"},on:{click:o.processImages}},[o._v("Process")])],1)],1)]],2)],1)},r.staticRenderFns=[]},{}],2:[function(t,e,o){"use strict";var r,s=t(1),n=(r=s)&&r.__esModule?r:{default:r};panel.plugin("sylvainjule/colorextractor",{fields:{colorextractor:n.default}})},{1:1}]},{},[2]);
